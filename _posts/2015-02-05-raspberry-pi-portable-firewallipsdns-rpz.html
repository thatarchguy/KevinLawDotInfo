---
layout: post
title: Raspberry Pi Portable Firewall/IPS/DNS-RPZ
date: '2015-02-05T23:33:00.001-08:00'
author: Kevin L
tags: 
modified_time: '2015-02-05T23:33:17.058-08:00'
thumbnail: http://3.bp.blogspot.com/-OcOM3D9KZJ8/VNRisIZZdKI/AAAAAAAAAMc/eJn3oVTqDHo/s72-c/2015-02-06-014348_484x151_scrot.png
blogger_id: tag:blogger.com,1999:blog-5768106710687360482.post-7304923558298076699
blogger_orig_url: http://blog.kevinlaw.info/2015/02/raspberry-pi-portable-firewallipsdns-rpz.html
---

<br /><br />Connecting to unsecured networks can be a risk. You really don't know what could be running on the network. We can use the raspberry pi to act as a firewall for our laptops.<br /><br />For class, my group was assigned a project to create a portable firewall using a raspberry pi. The pi would connect via wifi to any hotspot (xfinitywifi, starbucks, etc...) and have the host computer attached be completely secure.<br /><br />(Note: Blogger is trash for writing blog posts. Seriously this editor sucks)<br /><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-OcOM3D9KZJ8/VNRisIZZdKI/AAAAAAAAAMc/eJn3oVTqDHo/s1600/2015-02-06-014348_484x151_scrot.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-OcOM3D9KZJ8/VNRisIZZdKI/AAAAAAAAAMc/eJn3oVTqDHo/s1600/2015-02-06-014348_484x151_scrot.png" height="123" width="400" /></a></div><br /><h3> Setup</h3><h4> Prerequisites</h4>1x raspberry pi<br />1x 4gb sd card (<a href="https://learn.adafruit.com/setting-up-a-raspberry-pi-with-noobs/overview">raspbian installed</a>)<br />1x usb wifi adapter<br /><br />The default login for raspbian is pi:raspberry<br /><h4> Misc Configs</h4><span style="font-size: x-small;"><span style="font-family: Arial,Helvetica,sans-serif;">pi@raspberrypi ~ $ sudo su -<br />root@raspberrypi:~# apt-get update &amp;&amp; apt-get upgrade<br />root@raspberrypi:~# apt-get install isc-dhcp-server bind9 snort wpasupplicant wireless-tools openssh-server vim tmux</span></span><br /><br />Set a static IP address for eth0<br />We can define the pi's ethernet address as 10.11.12.13/24 since that subnet is rarely used, and it's easier to remember! <br />[/etc/networks/interfaces]<br /><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: x-small;">auto lo</span></span><br /><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: x-small;">iface lo inet loopback</span></span><br /><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: x-small;">auto eth0<br />iface eth0 inet static<br />&nbsp;&nbsp;&nbsp; address 10.11.12.13<br />&nbsp;&nbsp;&nbsp; netmask 255.255.255.0<br />allow-hotplug wlan0</span></span><br /><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: x-small;">iface wlan0 inet dhcp</span></span><br /><br />SSH only on laptop<br />[/etc/ssh/sshd_config]<br /><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: x-small;">ListenAddress 10.11.12.13</span></span><br /><br />We are going to need to give out ip addresses for the clients first! <br />[/etc/dhcp/dhcpd.conf]<br /><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: x-small;">default-lease-time 600;<br />max-lease-time 7200;<br />subnet 10.11.12.0 netmask 255.255.255.0 {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       range 10.11.12.100 10.11.12.200;<br />&nbsp;&nbsp;&nbsp;&nbsp;        option domain-name-servers 10.11.12.13;<br />&nbsp;&nbsp;&nbsp;&nbsp;        option routers 10.11.12.13;<br />}</span></span><br /><h3> Router / Firewall - IPtables</h3>The pi is going to act as the router for the laptop. <br />Now let's route some traffic from wlan0 to eth0!<br /><br /><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: x-small;">iptables -A FORWARD -i wlan0 -o eth0 -m state --state ESTABLISHED,RELATED -j ACCEPT<br />iptables -A FORWARD -i eth0 -o wlan0 -j ACCEPT<br />iptables -t nat -A POSTROUTING -o wlan0 -j MASQUERADE </span></span><br /><br />That will route traffic from the wifi to the laptop, and block all attempts to connect to the actual pi.<br /><br />We will script this up later :)<br /><br /><h3>DNS-RPZ - Bind9</h3>DNS-RPZ allows us to maintain a blocklist for bad domains.<br /><br />We use malware-domains.com for this, since that site provides a decently up-to-date file in bind9 format. You can easily supply your own list here.<br /><br />[cron-update-dns.sh]<br /><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: x-small;">#!/bin/bash<br />wget http://malware-domains.com/files/malwaredomains.zones.zip<br />unzip malwaredomains.zones.zip<br />sed -e 's/\/etc\/namedb\/blockeddomain.hosts/\/etc\/bind\/rpz\/blocked.zone/g' malwaredomains.zones &gt; blocked-local.conf<br />service bind9 restart<br />rm malwaredomains.zones.zip<br />rm malwaredomains.zones</span></span><br /><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: x-small;">echo "Blocklist updated: $(date)" &gt;&gt; /var/log/blocklist</span></span><br /><br />[/etc/bind/named.conf.options]<br /><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: x-small;">recursion yes;<br />forwarders {<br />&nbsp;&nbsp;&nbsp;&nbsp;           8.8.8.8;<br />&nbsp;&nbsp;&nbsp;&nbsp;           8.8.4.4;<br />    };</span></span><br /><br />[/etc/bind/named.conf.local]<span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: x-small;"><br />include "/etc/bind/blocked-local.conf";</span></span><br /><br />[/etc/bind/rpz/blocked.zone]<br /><div dir="ltr" id="docs-internal-guid-1aa06f2d-5dc6-6457-a1ef-7c2cceaa3e90" style="line-height: 1.15; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: x-small;"><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">&nbsp;&nbsp;&nbsp; </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">$TTL 600 &nbsp;&nbsp;&nbsp;</span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">&nbsp;&nbsp;&nbsp; </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">; 10 minutes</span></span></span></div><div dir="ltr" style="line-height: 1.15; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: x-small;"><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">&nbsp;&nbsp;&nbsp; </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">@ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">&nbsp;&nbsp;&nbsp; </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">SOA </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">&nbsp;&nbsp;&nbsp; </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">server.mydomain.com. root.mydomain.com. (</span></span></span></div><div dir="ltr" style="line-height: 1.15; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: x-small;"><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">&nbsp;&nbsp;&nbsp; </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">42 &nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">&nbsp;&nbsp;&nbsp; </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">; serial</span></span></span></div><div dir="ltr" style="line-height: 1.15; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: x-small;"><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">&nbsp;&nbsp;&nbsp; </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">900 &nbsp;&nbsp;&nbsp;</span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">&nbsp;&nbsp;&nbsp; </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">; refresh (15 minutes)</span></span></span></div><div dir="ltr" style="line-height: 1.15; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: x-small;"><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">&nbsp;&nbsp;&nbsp; </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">60 &nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">&nbsp;&nbsp;&nbsp; </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">; retry (1 minute)</span></span></span></div><div dir="ltr" style="line-height: 1.15; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: x-small;"><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">&nbsp;&nbsp;&nbsp; </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">604800 </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">&nbsp;&nbsp;&nbsp; </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">; expire (1 week)</span></span></span></div><div dir="ltr" style="line-height: 1.15; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: x-small;"><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">&nbsp;&nbsp;&nbsp; </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">43200 &nbsp;</span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">&nbsp;&nbsp;&nbsp; </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">; minimum (12 hours)</span></span></span></div><div dir="ltr" style="line-height: 1.15; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: x-small;"><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">&nbsp;&nbsp;&nbsp; </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">)</span></span></span></div><div dir="ltr" style="line-height: 1.15; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: x-small;"><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">&nbsp;&nbsp;&nbsp; </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">NS &nbsp;</span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">&nbsp;&nbsp;&nbsp; </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">server.mydomain.com.</span></span></span></div><div dir="ltr" style="line-height: 1.15; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: x-small;"><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">&nbsp;&nbsp;&nbsp; </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">MX &nbsp;</span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">&nbsp;&nbsp;&nbsp; </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">1 server.mydomain.com.</span></span></span></div><div dir="ltr" style="line-height: 1.15; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: x-small;"><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">&nbsp;&nbsp;&nbsp; </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">$TTL 302400 </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">&nbsp;&nbsp;&nbsp; </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">; 3 days 12 hours</span></span></span></div><div dir="ltr" style="line-height: 1.15; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: x-small;"><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">&nbsp;&nbsp;&nbsp; </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">@ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">&nbsp;&nbsp;&nbsp; </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">IN &nbsp;</span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">&nbsp;&nbsp;&nbsp; </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">A &nbsp;&nbsp;</span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">&nbsp;&nbsp;&nbsp; </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">10.11.12.13</span></span></span></div><div dir="ltr" style="line-height: 1.15; margin-bottom: 0pt; margin-top: 0pt;"><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: x-small;"><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">&nbsp;&nbsp;&nbsp; </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">* &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">&nbsp;&nbsp;&nbsp; </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">IN &nbsp;</span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">&nbsp;&nbsp;&nbsp; </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">A &nbsp;&nbsp;</span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">&nbsp;&nbsp;&nbsp; </span><span style="background-color: transparent; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;">10.11.12.13</span></span></span></div><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: x-small;"><br /></span></span><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: x-small;"><br /></span></span><br />Run that bash script once to kick it off, then add it to crontab if you want.<br /><h3> IPS - Snort</h3>Good ol' snort. You can pull in your own rules or use the default rules that come with the install. The default settings work decently, but can be tweaked.<br /><br />[/etc/snort/snort.debian.conf <br /><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: x-small;">DEBIAN_SNORT_INTERFACE="wlan0" # Change interface to wlan0</span></span><br /><br /><br /><br />Now we gotta connect to wifi. I wish webmin would supply a module for this, or an easier way for that matter.<br /><br />Basically, I just use<br /><span style="font-family: Arial,Helvetica,sans-serif;"><span style="font-size: x-small;">iwlist wlan0 scan | less<br />iwconfig wlan0 essid "xfinitywifi"  </span></span><br /><br /><br /><h3> Tie it all together</h3>Ssh login to the pi, connect to wifi using iwconfig commands. Then run this script! <br /><div class="gistLoad" data-id="04ce09ce803c40028037" id="gist-04ce09ce803c40028037">Loading ....</div><br /><br /><br /><br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-j5hf6p3gF9w/VNRf0CCQOQI/AAAAAAAAAMU/inTAj9wvTdw/s1600/20150206_012435.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://4.bp.blogspot.com/-j5hf6p3gF9w/VNRf0CCQOQI/AAAAAAAAAMU/inTAj9wvTdw/s1600/20150206_012435.jpg" height="360" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">It works!</td></tr></tbody></table><br /><br /><br /><br /><br /><br /><script src="https://raw.github.com/moski/gist-Blogger/master/public/gistLoader.js" type="text/javascript"></script>