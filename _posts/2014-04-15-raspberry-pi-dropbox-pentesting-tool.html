---
layout: post
title: Raspberry Pi Dropbox Pentesting Tool
date: '2014-04-15T23:40:00.000-07:00'
author: Kevin L
tags: 
modified_time: '2014-04-15T23:50:32.197-07:00'
thumbnail: /images/post_raspipentest/thumb_raspi.jpg
blogger_id: tag:blogger.com,1999:blog-5768106710687360482.post-5537647369774792220
blogger_orig_url: http://blog.kevinlaw.info/2014/04/raspberry-pi-dropbox-pentesting-tool.html
---
Converted from Blogger. Please excuse any layout errors!

<div class="separator" style="clear: both; text-align: center;"></div>
<div class="separator" style="clear: both; text-align: center;"></div>
<div class="separator" style="clear: both; text-align: center;"></div>
<div class="separator" style="clear: both; text-align: center;"></div>
<div class="separator" style="clear: both; text-align: center;"></div>
<div class="separator" style="clear: both; text-align: center;"></div>
<div class="separator" style="clear: both; text-align: center;"></div>
<br />
<br />I finally got my hands on a Raspberry Pi to play around with. I could see the potential for malicious intent as soon as I saw it. The first thing I did was order a <a href="https://www.adafruit.com/products/966" target="_blank">low profile microsd card adapter</a>. This takes care of the obnoxious sd card sticking out the back, and allows for easier hiding of the Pi.
<br />
<br />
<table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;">
    <tbody>
        <tr>
            <td style="text-align: center;">
                <a href="/images/post_raspipentest/raspi.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="/images/post_raspipentest/raspi.jpg" height="180" width="320" />
                </a>
            </td>
        </tr>
        <tr>
            <td class="tr-caption" style="text-align: center;">Check out the slick low profile microsd card adapter</td>
        </tr>
    </tbody>
</table>
<br />
<div style="text-align: center;">I wanted the Pi to do a few things for me: </div>
<div style="text-align: center;">&nbsp;&nbsp;&nbsp; Only require Network and Power</div>
<div style="text-align: center;">&nbsp;&nbsp;&nbsp; Call back to control once it was powered on</div>
<div style="text-align: center;">&nbsp;&nbsp;&nbsp; Recon the network and report back</div>
<div style="text-align: center;">&nbsp;&nbsp;&nbsp; Allow me to remote in and manually exploit </div>
<br />I looked at the various pentest distros for the Pi. I ended up with <a href="http://pwnpi.sourceforge.net/" target="_blank">PwnPi</a>. After seeing the little power this thing has, I would've been more comfortable with <a href="http://www.raspbian.org/" target="_blank">Raspbian</a>. I say this because PwnPi takes forever to do things. Metasploit takes about 15 minutes to start up. I'm using a class 10 SDHC card as well. It's just nice to know the tools are available if I desperately needed them.
<br />
<br />After loading up PwnPi, I made a user called "pi". I generated ssh keys so it can ssh into my control server without a password. I made a user on my control server called "pi" as well. (And added the usual key-only login security measures, etc...)
<br />
<br />Now that we have ssh keys and a server to callback to, we can setup a script to automatically callback when turned on:
<br />
<div class="gistLoad" data-id="10814406" id="gist-10814406">Loading ....</div>
<br />Save as foo.sh , and drop it in a folder on the pi. Then make a crontab for this to run every minute or so. That way if connection is dropped, it will keep retrying to connect back.
<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
    <a href="/images/post_raspipentest/raspberrypi_ssh.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="/images/post_raspipentest/raspberrypi_ssh.png" height="141" width="400" />
    </a>
</div>&nbsp;
<br />Now we have most of the requirements that I wanted with that simple bash script. But what if we wanted a little more insight into the network we are connecting into. <a href="http://en.wikipedia.org/wiki/Operations_security" target="_blank">Opsec</a> is important, and you do not want to be too noisy on the network at once.
<br />
<br />With that in mind, I wrote a dirty nmap script that scans the network and scp's the report back to control:
<br />
<div class="gistLoad" data-id="10814958" id="gist-10814958">Loading .... </div>
<br />&nbsp;The output looks like this:
<br />
<div class="separator" style="clear: both; text-align: center;">
    <a href="/images/post_raspipentest/raspberrypi_nmap.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="/images/post_raspipentest/raspberrypi_nmap.png" height="612" width="640" />
    </a>
</div>
<br />
<br />
<br />Now you know what exploits you want to run before you even manually connect in and go to work!
<br />
<br />
<br />
<br />Back to what I was saying about the Pi not being all that powerful. It would be ideal to connect in and run exploits right from the Pi. This was not the case, since tools and scans took forever to run.
<br />
<br />I ended up ssh tunneling my tools through the pi. Maybe in the future I'll put openvpn certs on it and route all traffic between the network it's on the the vpn. That way I can connect to the vpn and run train from it.
<br />
<br />
<br />The Rasbperry Pi can be a great tool to have when pentesting or causing havoc (same thing right? :P )
<br />You can put it in a inconspicuous case and no one will give it a second look:
<br />
<br />
<table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;">
    <tbody>
        <tr>
            <td style="text-align: center;"><img alt="Pi IMG" src="http://www.tunnelsup.com/images/pi6.jpg" style="margin-left: auto; margin-right: auto;" />
            </td>
        </tr>
        <tr>
            <td class="tr-caption" style="text-align: center;">laptop battery case</td>
        </tr>
    </tbody>
</table>
<table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;">
    <tbody>
        <tr>
            <td style="text-align: center;"><img alt="Image" src="/images/post_raspipentest/IMAG0434-50pc-anno-1024x577.jpg?84cd58" height="225" style="margin-left: auto; margin-right: auto;" width="400" />
            </td>
        </tr>
        <tr>
            <td class="tr-caption" style="text-align: center;">Wireless router case</td>
        </tr>
    </tbody>
</table>
<br />
<br />
<script src="https://raw.github.com/moski/gist-Blogger/master/public/gistLoader.js" type="text/javascript"></script>